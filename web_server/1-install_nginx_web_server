#!/usr/bin/env bash
# Configures a new Ubuntu machine with nginx web server listening on port 80

# Update package list and install nginx
apt-get update -y
apt-get install -y nginx

# Create the required HTML content
echo "Holberton School for the win!" > /var/www/html/index.nginx-debian.html

# Ensure nginx starts and is running
service nginx start

# Verify nginx is running
if pgrep nginx > /dev/null; then
    echo "Nginx is running"
else
    # If not running, try alternative start method
    /usr/sbin/nginx
fi

# Test the configuration
curl -s localhost > /tmp/nginx_test
if grep -q "Holberton School" /tmp/nginx_test; then
    echo "Nginx is serving the correct content"
else
    echo "Content test failed"
    cat /tmp/nginx_test
fi
